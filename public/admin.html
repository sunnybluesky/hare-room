<!DOCTYPE html>
<html lang="ja" data-bs-theme="blue">

<head>
    <title>Harezora-Sites</title>
    <meta charset="utf-8">
    <style>
        body {
            background: #000
        }
    </style>
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <!-- Bootstrap CSSの読み込み -->
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css"
        integrity="sha384-JcKb8q3iqJ61gNV9KGb8thSsNjpSL0n8PARn9HuZOnIxN0hoP+VmmDGMN5t9UJ0Z" crossorigin="anonymous">

    <link rel="stylesheet" href="style/main.css">
    <script src="js/preload.js" defer></script>
    <script src="https://apis.google.com/js/api.js"></script>
    <script src="https://accounts.google.com/gsi/client"></script>
    <dialog class="entrants"></dialog>
</head>

<body>
    <header></header>

    <div class="container my-5 ">
        <h1>管理者用ページ</h1>
        <p id="ip">あなたのIPアドレス : Waiting...</p>
        <p id="server-res-check">サーバーレスポンス : Waiting...</p>
        <p>管理者権限：<span id="admin-verified">認証されていません...</span></p>
    </div>

    <div id="user-info" class="hide"></div>
    <button class="btn btn-outline-success hide" id="sign-out-btn">Sign out</button>
    <!-- jQuery,Popper.js,Bootstrap JSの順番で読み込む-->
    <!-- jQueryの読み込み -->
    <script src="https://code.jquery.com/jquery-3.5.1.slim.min.js"
        integrity="sha384-DfXdz2htPH0lsSSs5nCTpuj/zy4C+OGpamoFVy38MVBnE+IbbVYUew+OrCXaRkfj"
        crossorigin="anonymous"></script>
    <!-- Popper.jsの読み込み -->
    <script src="https://cdn.jsdelivr.net/npm/popper.js@1.16.1/dist/umd/popper.min.js"
        integrity="sha384-9/reFTGAW83EW2RDu2S0VKaIzap3H66lZH81PoYlFhbGU+6BZp6G7niu735Sk7lN"
        crossorigin="anonymous"></script>
    <!-- Bootstrapのjsの読み込み -->
    <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/js/bootstrap.min.js"
        integrity="sha384-B4gt1jrGC7Jh4AgTPSdUtOBvfO8shuf57BaghqFfPlYxofvL8/KUEfYiJOMMV+rV"
        crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/socket.io/4.5.4/socket.io.js"></script>
    <!--メイン部分-->
    <script>
        const socket = io()

        let ip = null;
        async function getIp() {
            const script = document.createElement('script');

            script.src = 'https://ipinfo.io?callback=callback';
            document.body.appendChild(script);
            document.body.removeChild(script);
        }
        getIp();
        function callback(data) {
            console.log(data.ip);
            ip = data.ip;
            document.getElementById("ip").textContent = "あなたのIPアドレス : " + ip
            
        socket.emit("check-ip",ip)
        }
        socket.on("res-ok",()=>{
            document.getElementById("server-res-check").textContent = "サーバーレスポンス : OK"
        })
        socket.on("reload",()=>{
            location.reload()
        })
        socket.on("callback",(name,addr)=>{
            socket.emit(name,addr)            
        })
        socket.on("admin-verified",()=>{
            document.querySelector("#admin-verified").textContent = "認証されました！"
        })
    </script>
    <script src="js/main.js" type="module" defer></script>
    <script src="js/account.js" type="module"></script>



</body>

</html>